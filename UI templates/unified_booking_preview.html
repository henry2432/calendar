<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kayarine 預約所有裝備 (Unified Booking)</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: #f7fafc; padding: 20px; }
        
        .unified-booking {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .kb-section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            color: #2d3748;
        }

        .kb-subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #edf2f7;
            color: #2d3748;
        }

        /* Date Section */
        .kb-date-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        /* Flatpickr Customization */
        .flatpickr-calendar {
            box-shadow: none !important;
            border: 1px solid #e2e8f0 !important;
            border-radius: 12px !important;
        }
        
        /* Disabled dates (blocked) should look faded but visible */
        .flatpickr-day.flatpickr-disabled,
        .flatpickr-day.flatpickr-disabled:hover {
            background: #f7fafc !important;
            color: #cbd5e0 !important;
            border-color: transparent !important;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        /* Holidays that are blocked specifically */
        .flatpickr-day.kb-weekend.flatpickr-disabled {
            background: #feebc8 !important; /* Faded Orange */
            color: #dd6b20 !important;
            opacity: 0.5;
        }

        /* Hide extra days */
        .flatpickr-day.nextMonthDay, .flatpickr-day.prevMonthDay { visibility: hidden; }
        
        .kb-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            font-size: 0.85rem;
            color: #718096;
            margin-top: 10px;
        }
        .kb-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .kb-dot.weekday { border: 1px solid #cbd5e0; }
        .kb-dot.weekend { background: #fbd38d; }

        /* Grid for Equipment */
        .kb-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Force 2 cols on mobile */
            gap: 10px; /* Smaller gap */
        }
        
        @media (min-width: 768px) {
            .kb-grid {
                grid-template-columns: repeat(4, 1fr); /* 4 cols on desktop */
                gap: 20px;
            }
        }

        .kb-card {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            transition: transform 0.2s;
        }
        .kb-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        .kb-card-img {
            width: 100%;
            padding-top: 100%; /* 1:1 Aspect Ratio (Square) */
            background: #edf2f7;
            border-radius: 8px;
            margin-bottom: 10px;
            background-size: cover;
            background-position: center;
            position: relative;
            /* Ensure images fit cleanly */
            overflow: hidden;
        }

        .kb-card-title { font-weight: 600; margin-bottom: 5px; font-size: 0.9rem; }
        .kb-card-price { color: #ed8936; font-weight: bold; font-size: 0.85rem; margin-bottom: 8px; }

        /* Pill Control */
        /* Custom Pill for Unified Cards (Based on User Template) */
        .kb-pill {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
            width: 100%;
            max-width: 120px;
            margin: 0 auto;
        }
        
        /* Common Button Style */
        .kb-btn {
            width: 32px; height: 32px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            font-size: 1.2rem; line-height: 1;
            transition: all 0.2s;
            /* Default fallback */
            border: 1px solid #cbd5e0;
            background: #fff;
            color: #4a5568;
        }

        /* Minus Button: Black Border, White Background */
        /* Note: We use :first-child or explicit class if available.
           In the HTML below, it's just <div class="kb-btn">-</div>.
           We'll use nth-child(1) for minus and nth-child(3) for plus */
        
        .kb-pill .kb-btn:nth-child(1) {
            background: #ffffff;
            border: 1px solid #000000;
            color: #000000;
        }
        .kb-pill .kb-btn:nth-child(1):hover { background: #f7fafc; }
        
        /* Plus Button: Orange Background, White Text */
        .kb-pill .kb-btn:nth-child(3) {
            background: #ed8936;
            border: 1px solid #ed8936;
            color: #ffffff;
        }
        .kb-pill .kb-btn:nth-child(3):hover { background: #dd6b20; border-color: #dd6b20; }

        .kb-val {
            width: 40px;
            text-align: center;
            background: transparent;
            border: none;
            font-weight: 500;
            font-size: 1.1rem;
            color: #2d3748;
        }

        /* Row Style for Sales & Rentals */
        .kb-list-view {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .kb-sale-row {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            gap: 15px;
            background: #fff;
        }
        
        .kb-sale-thumb {
            width: 50px;
            height: 50px;
            background: #edf2f7;
            border-radius: 6px;
            flex-shrink: 0;
            background-size: cover;
            background-position: center;
        }
        
        .kb-sale-info { flex-grow: 1; }
        .kb-sale-name { font-weight: 600; font-size: 0.95rem; color: #2d3748; }
        .kb-sale-price { font-size: 0.85rem; color: #ed8936; font-weight: bold; }

        /* Footer */
        .kb-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .kb-total { font-size: 1.5rem; font-weight: 700; color: #ed8936; }
        .kb-submit {
            padding: 12px 30px;
            background: #4299e1; color: white; border: none; border-radius: 30px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer;
        }

    </style>
</head>
<body>

    <div class="unified-booking">
        <h1 class="kb-section-title">預約所有裝備</h1>

        <!-- 1. Date -->
        <div class="kb-subtitle">1. 選擇日期</div>
        <div class="kb-date-wrapper">
            <input type="text" id="date_picker" style="display:none;">
        </div>
        <div class="kb-legend">
            <div><span class="kb-dot weekday"></span>平日</div>
            <div><span class="kb-dot weekend"></span>假日</div>
        </div>

        <!-- 2. Equipment (Main) - Grid (2 cols mobile / 4 cols desktop) -->
        <div class="kb-subtitle">2. 選擇裝備</div>
        <div class="kb-grid">
            <div class="kb-card">
                <div class="kb-card-img" style="background-image:url('https://placehold.co/200x200?text=Single+Kayak')"></div>
                <div class="kb-card-title">單人獨木舟</div>
                <div class="kb-card-price">$100</div>
                <div class="kb-pill"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
            <div class="kb-card">
                <div class="kb-card-img" style="background-image:url('https://placehold.co/200x200?text=Double+Kayak')"></div>
                <div class="kb-card-title">雙人獨木舟</div>
                <div class="kb-card-price">$200</div>
                <div class="kb-pill"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
            <div class="kb-card">
                <div class="kb-card-img" style="background-image:url('https://placehold.co/200x200?text=SUP')"></div>
                <div class="kb-card-title">直立板 (SUP)</div>
                <div class="kb-card-price">$150</div>
                <div class="kb-pill"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
        </div>

        <!-- 3. Add-ons: Rentals - Row List -->
        <div class="kb-subtitle">3. 附加租借</div>
        <div class="kb-list-view">
            <div class="kb-sale-row">
                <div class="kb-sale-thumb" style="background-image:url('https://placehold.co/60?text=Mask')"></div>
                <div class="kb-sale-info">
                    <div class="kb-sale-name">租借浮潛面罩</div>
                    <div class="kb-sale-price">$30</div>
                </div>
                <div class="kb-pill" style="width:100px;"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
        </div>

        <!-- 4. Add-ons: Sales - Row List -->
        <div class="kb-subtitle">4. 加購產品</div>
        <div class="kb-list-view">
            <div class="kb-sale-row">
                <div class="kb-sale-thumb" style="background-image:url('https://placehold.co/60?text=Phone')"></div>
                <div class="kb-sale-info">
                    <div class="kb-sale-name">手機防水袋</div>
                    <div class="kb-sale-price">$50</div>
                </div>
                <div class="kb-pill" style="width:100px;"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
            <div class="kb-sale-row">
                <div class="kb-sale-thumb" style="background-image:url('https://placehold.co/60?text=Towel')"></div>
                <div class="kb-sale-info">
                    <div class="kb-sale-name">沙灘毛巾</div>
                    <div class="kb-sale-price">$80</div>
                </div>
                <div class="kb-pill" style="width:100px;"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
            <div class="kb-sale-row">
                <div class="kb-sale-thumb" style="background-image:url('https://placehold.co/60?text=Shirt')"></div>
                <div class="kb-sale-info">
                    <div class="kb-sale-name">防曬衣</div>
                    <div class="kb-sale-price">$120</div>
                </div>
                <div class="kb-pill" style="width:100px;"><div class="kb-btn">-</div><input class="kb-val" value="0" readonly><div class="kb-btn">+</div></div>
            </div>
        </div>

        <!-- Footer -->
        <div class="kb-footer">
            <div>總計 Total: <span class="kb-total">$0</span></div>
            <button class="kb-submit">立即預約</button>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        flatpickr("#date_picker", { 
            inline: true, 
            dateFormat: "Y-m-d",
            onDayCreate: function(dObj, dStr, fp, dayElem){
                var date = dayElem.dateObj;
                if (date.getDay() === 0 || date.getDay() === 6) {
                    dayElem.classList.add("kb-weekend");
                }
            }
        });
    </script>
</body>
</html>
